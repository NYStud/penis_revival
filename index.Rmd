---
title: "World Penis Data… Again"
author: "Tobi & Lukas"
date: "Rendered `r format(Sys.time(), '%F %H:%M')`"
output: 
  html_document
---

```{r setup_index, include=FALSE}
source("setup.R")
```

A while ago, [I analyzed the World Penis Data](https://blog.jemu.name/post/2015/08/i-analyzed-some-world-penis-data---because-why-not/), because let's face it, the inclined data enthusiast can't resist a dataset like [this](http://www.everyoneweb.com/worldpenissize). Sadly, my old code to scrape the table on that page doesn't work anymore, and I have not figured out a new way to get the data, so I have to rely on the data I saved the last time and included in the [tadaadata/loldata](https://github.com/tadaadata/loldata) package.  

Anyway, long story short: I don't like the look of my old analysis, because that was done in a time before I bothered with ggplot2-prettification. So now we try this again.

## A Look at the Data Sources

First up, let's see where the data is from in the first place.

```{r firstlook}
loldata::penis %>%
  group_by(Region) %>%
  tally() %>%
  ggplot(aes(x = reorder(Region, n), y = n)) +
  geom_col(alpha = .7) +
  coord_flip() +
  labs(title = "World Penis Data", 
       subtitle = "Number of Studies in Dataset by Region",
       x = "", y = "Number of Studies", caption = plot_caption)

loldata::penis %>%
  group_by(Region) %>%
  summarize(n = sum(N)) %>%
  ggplot(aes(x = reorder(Region, n), y = n)) +
  geom_col(alpha = .7) +
  coord_flip() +
  scale_y_continuous(breaks = seq(0, 10^5, 5000), 
                     minor_breaks = seq(0, 10^5, 1000)) +
  labs(title = "World Penis Data", 
       subtitle = "Total N of Studies by Region",
       x = "", y = "Total N", caption = plot_caption)
```

As we can see, our data seems to be most reliable for Europe, South America, multiple Asias and Africa.  
Oddly enough, we have relatively little data on North America, and our data on the Pacific Islands and Central Asia should probably be taken with a grain of salt. However, I have no idea what an appropriate sample size for data like this would be, so I'm mainly eyeballing and trying to sound knowledgable here.

Let's look at the N of the individual datapoints (because every row in our dataset represents the data of a specific study). We'll exclude rows with an N over 200, because that's probably a sufficiently large sample anyway.

```{r firstlook_n}
loldata::penis %>%
  filter(N < 200) %>%
  ggplot(data = ., aes(x = N)) +
  geom_histogram(binwidth = 5, alpha = .7) +
  scale_x_continuous(breaks = seq(0, 200, 10),
                     minor_breaks = seq(0, 200, 5)) +
  labs(title = "World Penis Data", subtitle = "Reported N per Study",
       x = "Reported N", y = "Frequency", caption = plot_caption)
```


Seems like we have a few data points based on fairly small samples.  
For the remainder of the analysis, we'll be excluding these data points with an N smaller than 50, because that's the arbitrary judgement of precision I just came up with.

## The Raw Data

If you're curious about the data itself, here's an embedded version of the dataset.  
We arranged the data into two datasets, one *wide* and one *long*, but let's just look at the difference to explain that.

```{r forstlook_table_wide}
penis %>%
  select(-Method, -N, -Source, everything(), Method, N, Source) %>%
  datatable(style = "bootstrap", rownames = F, 
            fillContainer = T, 
            height = 100,
            options = list(
              bInfo = F,
              paging = F,
              autoWidth = TRUE,
              sDom  = '<"top">lrt<"bottom">ip'), 
            caption = "Penis Data (wide format)") %>%
  formatRound(columns = c(4, 6:11), digits = 1)
```

As you can see, with have some more or less detailed geographical information, various measurements (and calculated measurements, as *volume* is calculated by length and circumference, assuming a perfect cylinder, and the growth factor, which is simply *erect* divided by *flaccid*), details on the *method* the data was obtained (either self-reported or measured, and yes, we'll look at that in detail), and details of the data source (source study, N).  

We also have two variables for both flaccid and erect states, which is fine for comparing both states, but sometimes it can be inconvenient.  
That's why we data-wrangled the above dataset in a long format, which excludes the *growth_* variables but adds a *state* variable:

```{r forstlook_table_long}
penis_long %>%
  select(-Method, -N, -Source, everything(), Method, N, Source) %>%
  datatable(style = "bootstrap", rownames = F, 
            fillContainer = T, 
            height = 100,
            options = list(
              bInfo = F,
              paging = F,
              autoWidth = TRUE,
              sDom  = '<"top">lrt<"bottom">ip'), 
            caption = "Penis Data (long format)") %>%
  formatRound(columns = 3:5, digits = 1)
```

So this is what the data looks like.  
As already mentioned, [this is the original source where we got the data from](http://www.everyoneweb.com/worldpenissize), in case anyone asks… again.
